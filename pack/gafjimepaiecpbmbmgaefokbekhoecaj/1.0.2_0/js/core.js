class Translation{constructor(){this.Utils=new Config}save(){chrome.storage.local.set({tl:$("#languages").val(),vm:$("#view-mode").val(),double_click:$("#double-click").val()}),$("#notification").attr("class","notification is-warning"),$("#message").html(chrome.i18n.getMessage("automatic_save")),setTimeout(function(){$("#message").html(),$("#notification").attr("class","hide")},2e3)}getTranslateToLanguage(){return this.Utils.config.tl?this.Utils.config.tl:this.normalizeLanguageCode(window.navigator.language)}supportedLocale(a){return-1!==["ar","bg","ca","cs","da","de","el","en","en-GB","en-US","es","es-419","et","fi","fil","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nl","no","pl","pt-BR","pt-PT","ro","ru","sk","sl","sr","sv","th","tl","tr","uk","vi","zh-CN","zh-TW"].indexOf(a)}normalizeLanguageCode(a){return"zh-tw"===a.toLowerCase()?"zh-TW":"zh-cn"===a.toLowerCase()?"zh-CN":2<=a.length&&this.supportedLocale(a)?a.substr(0,2):"en"}loadSupportedViewModes(){let a=document.querySelector("#view-mode"),b={ont:chrome.i18n.getMessage("view_mode_ont"),ognt:chrome.i18n.getMessage("view_mode_ognt")};this.populateSelect(a,b),chrome.storage.local.get("vm",function(b){this.setSelectedValue(a,b.vm)}.bind(this))}loadSupportedDblClickOptions(){const a=document.querySelector("#double-click"),b={double_click_true:chrome.i18n.getMessage("double_click_true"),double_click_false:chrome.i18n.getMessage("double_click_false")};this.populateSelect(a,b),chrome.storage.local.get("double_click",b=>{this.setSelectedValue(a,b.double_click)})}createContextMenu(){chrome.contextMenus.create({title:chrome.i18n.getMessage("translate")+" '%s'",contexts:["selection"],onclick:this.translate.bind(this)})}openUrl(a,b){chrome.tabs.create({url:a,selected:b})}setSelectedValue(a,b){for(let c,d=0;d<a.children.length;d++)if(c=a.children[d],c.value===b){c.selected=!0;break}}populateSelect(a,b){for(let c in b){let d=document.createElement("option");d.value=c,d.textContent=b[c],a.appendChild(d)}return a}changeElementsVisibility(){let a=document.getElementsByTagName("select"),b=document.getElementsByTagName("label");for(let b=0;b<a.length;b++)a[b].className="visible";for(let a=0;a<b.length;a++)b[a].className="visible"}translate(a){let b=a.selectionText,c=Utils.config.vm,d=b.toLowerCase()===chrome.i18n.getMessage("name").toLowerCase()?"la":"auto";if("tt"!==c){let a="http://translate.google.com/#"+d+"|"+this.getTranslateToLanguage()+"|"+encodeURIComponent(b);this.openUrl(a,!("ognt"!==c))}}}